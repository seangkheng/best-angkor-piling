{% extends "base.html" %}

{% block title %}Add New Transaction | បន្ថែមប្រតិបត្តិការថ្មី{% endblock %}

{% block content %}
<h2>Add New Transaction | បន្ថែមប្រតិបត្តិការថ្មី</h2>
<form method="POST" action="{{ url_for('add_transaction') }}">
    <label for="pile_id">Pile (SKU) | សសរ (SKU):</label>
    <select id="pile_id" name="pile_id" required>
        <option value="">-- Select Pile | ជ្រើសរើសសសរ --</option>
        {% for pile in piles %}
            <option value="{{ pile.id }}">{{ pile.sku }} ({{ pile.pile_type }} {{ pile.size }} L:{{ "%.1f"|format(pile.length) }}m)</option>
        {% endfor %}
    </select>

    <label for="site_id">Customer Site (Optional) | ការដ្ឋានអតិថិជន (បើមាន):</label>
    <select id="site_id" name="site_id">
        <option value="None">-- No Specific Site | មិនមានការដ្ឋានជាក់លាក់ --</option>
        {% for site in customer_sites %}
            <option value="{{ site.id }}">{{ site.name }}</option>
        {% endfor %}
    </select>

    <label for="transaction_type">Transaction Type | ប្រភេទប្រតិបត្តិការ:</label>
    <select id="transaction_type" name="transaction_type" required>
        <option value="">-- Select Type | ជ្រើសរើសប្រភេទ --</option>
        <option value="in">In (Received) | ទទួល</option>
        <option value="out">Out (Sold) | លក់ចេញ</option>
    </select>

    <label for="quantity">Quantity | ចំនួន:</label>
    <input type="number" id="quantity" name="quantity" min="1" required>

    <label for="unit_price_at_transaction">Unit Price at Transaction ($) | តម្លៃឯកតានៅពេលប្រតិបត្តិការ ($):</label>
    <input type="number" step="0.01" id="unit_price_at_transaction" name="unit_price_at_transaction" required>

    <label for="notes">Notes | កំណត់ចំណាំ:</label>
    <textarea id="notes" name="notes" rows="3"></textarea>

    <button type="submit"><i class="fas fa-plus-circle"></i> បន្ថែមប្រតិបត្តិការ | Add Transaction</button>
    <a href="{{ url_for('manage_transactions') }}" class="cancel-button"><i class="fas fa-times-circle"></i> បោះបង់ | Cancel</a>
</form>
{% endblock %}
